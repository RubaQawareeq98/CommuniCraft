const express = require('express');
const router = express.Router()

const { Sequelize, DataTypes } = require('sequelize');
const sequelize = new Sequelize('CommuniCraft', 'root', '123456789', {
    host: 'localhost',
    dialect: 'mysql'
  });
  
  
  
  const Skill = sequelize.define('Skill', {
      id: {
          type: DataTypes.INTEGER,
          allowNull: false,
          primaryKey: true
      },
      name: {
          type: DataTypes.STRING,
          allowNull: false
      },
      description: {
          type: DataTypes.STRING,
          allowNull: false
      },
      
  });

  async function createTable() {
    try {
      await Skill.sync({force:true});
      console.log('Table created successfully');
    } catch (error) {
      console.error('Error creating table:', error);
    }
  }

  // createTable()
router.get('/skills', async (req, res) => {

    try {
        const skill = await Skill.findAll();
        res.send(skill);
    } catch (error) {
        
        console.error("Error fetching users");
    }
});


// // Add new Skill
router.put('/addSkill', async (req, res) => {
  try {
    const newSkill = await Skill.create({
      id: Number(req.body.id),
      name: req.body.name,
      description: req.body.description,
    });
    res.send("New Skill created:");
  } catch (error) {
    res.status(500).send("Error creating new Skill");
  }
});

module.exports =router;